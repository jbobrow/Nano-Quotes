<html>
    <head>
        <title>Nanotronics | Daily Inspiration</title>
        <!-- Unfurl Meta -->
        <meta property="og:url" content="https://jbobrow.github.io/Nano-Quotes/"/>
        <meta property="og:title" content="Nanotronics | Daily Inspiration"/>
        <meta property="og:description" content="Inspirational quotes from Nanotronics HQ in Brooklyn"/>
        <meta property="og:site_name" content="Nanotronics | Daily Inspiration"/>
        <meta property="og:image" content="img/NanotronicsWelcome.jpg"/>
        <link href="css/flapper.css" type="text/css" rel="stylesheet" />
        <script src="libs/jquery/1.8.2/jquery.min.js"></script>
        <script src="transform/dist/jquery.transform-0.9.3.min.js"></script>
        <script src="src/jquery.flapper.js"></script>
        <script src="src/flapdemo.js"></script>
        <style type="text/css">
            body {
                font-family: "Neue Montreal", "Helvetica Neue", Arial, sans-serif;
                color: #333;
                background-color: #fff;
                margin: 0;
                padding: 0;
            }

            .page {
                width: 1200px;
                margin: 50px auto 0;
            }

            h1 {
                text-align: center;
                font-size: 24px;
            }

            .displays {
                padding: 80px;
                background-color: #000;
                border-radius: 0px;
                box-shadow: 0 0 12px 4px #000 inset;
            }

            .share-icon {
                position: relative;
                width:28px;
                height:0px;
                margin: 24px auto -20px auto;
                opacity: 0;
                -webkit-transition: opacity 0.2s ease-in-out;
                -moz-transition: opacity 0.2s ease-in-out;
                transition: opacity 0.2s ease-in-out;
            }

            .displays:hover .share-icon{
                opacity: 0.15;
            }

            .displays .share-icon:hover {
                opacity: 0.3;
            }

            #twitter {
                display: block;
            }

            #bluesky {
                display: none;
            }

            .flapper {
                margin-bottom: 2px;
                text-align: center;
            }

            .inputarea {
                display: none; /* Hide input area */
            }

            #quote {
                font-family: sans-serif;
                font-size: 1.2em;
                text-align: center;
                margin-bottom: 10px;
                color: #000;
            }

            #author {
                font-family: sans-serif;
                font-size: 1.2em;
                color: #000;
                text-align: center;
            }

            #thanks {
                max-width: 600px;
                height: 480px;
                margin: 0 auto;
                align-content: center;
            }

            #thanks p {
                font-family: "PP Neue Montreal", "Helvetica Neue", Arial, sans-serif;
                font-size: 18px;
                line-height: 27px;
                color: #00000099;
                text-align: justify;
/*                padding-top: 18px;
                border-top: 1px solid #00000044;                
*/            }

            a {
                color: #00000066;
                text-decoration: none;
            }

            a:hover {
                color: #000000AA;
                text-decoration: underline;
            }

            #nano_sticker {
                display: block;
                margin: auto;
                width: 50px;
                height: 50px;
            }

            footer {
                font-family: "PP Neue Montreal", "Helvetica Neue", Arial, sans-serif;
                font-size: 14px;
                line-height: 20px;
                color: #00000099;
                text-align: center;
                padding: 30px;
            }

            div.inline {
                display: inline-block;
                vertical-align: bottom;
            }

            div.activity {
                width: 12px;
                height: 12px;
                border-radius: 6px;
                background-color: #250000;
                position: relative;
                top: 33px;
                left: -15px;
            }

            div.activity.active {
                background-color: #ED1C24;
            }

            ::selection {
                color: #fff;
                background: #ED1C24;
            }

            .timer-container {
              width: 100%; /* Full width of the line */
              height: 1px; /* Height of the line */
              background-color: #00000011; /* Gray line background */
              overflow: hidden; /* Ensure the black line stays within bounds */
              position: relative;
            }

            .timer-line {
              width: 100%; /* Initially full width */
              height: 100%; /* Match the container height */
              background-color: #00000033; /* Black line color */
              position: absolute;
              top: 0;
              left: 0;
              animation: shrink 30s linear infinite; /* Shrink every 30 seconds */
            }

            @keyframes shrink {
              0% {
                width: 100%; /* Start with full width */
              }
              100% {
                width: 0; /* Shrink to 0 width */
              }
            }
        </style>
    </head>
    <body>
        <div class="page">
            <!-- <h1>FLAPPER DEMO</h1> -->
            <div class="displays" onClick="shareQuote()">
                <div class="activity"></div><input class="display M" />
                <div class="activity"></div><input class="display M" />
                <div class="activity"></div><input class="display M" />
                <div class="activity"></div><input class="display M" />
                <div class="activity"></div><input class="display M" />
                <div class="activity"></div><input class="display M" />
                <div class="share-icon">
                    <svg id="bluesky" width="28" height="28" viewBox="0 0 512 451" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M110.976 30.336C169.696 74.4 232.832 163.776 256 211.712C279.2 163.776 342.304 74.432 401.024 30.336C443.36 -1.43998 512 -26.048 512 52.224C512 67.872 503.04 183.584 497.792 202.368C479.488 267.648 412.896 284.32 353.664 274.24C457.216 291.872 483.584 350.24 426.656 408.64C318.624 519.488 271.392 380.8 259.296 345.28C257.056 338.752 256 335.68 256 338.304C256 335.712 254.944 338.752 252.736 345.28C240.608 380.8 193.376 519.488 85.344 408.64C28.448 350.24 54.784 291.84 158.304 274.24C99.104 284.32 32.48 267.68 14.208 202.368C8.96 183.584 0 67.84 0 52.224C0 -26.048 68.64 -1.43998 110.976 30.336Z" fill="white"/>
                        </svg>
                    <svg id="twitter" width="28" height="28" viewBox="0 0 119 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M106.774 24.9217C106.853 26.018 106.853 27.1081 106.853 28.1982C106.853 61.5587 82.3106 100 37.4585 100C23.6401 100 10.8028 95.8589 0 88.6668C1.96194 88.8986 3.85121 88.9801 5.89187 88.9801C17.2941 88.9801 27.7881 84.9956 36.1747 78.1982C25.4507 77.9664 16.4645 70.6992 13.3642 60.7004C14.872 60.9322 16.3858 61.0888 17.9723 61.0888C20.1583 61.0888 22.3564 60.7756 24.3971 60.2305C13.2128 57.8875 4.83824 47.7321 4.83824 35.4655V35.1522C8.08997 37.0254 11.8625 38.197 15.859 38.3536C9.28893 33.8303 4.98356 26.0932 4.98356 17.3412C4.98356 12.6551 6.18858 8.35735 8.3019 4.61095C20.3097 19.9161 38.3607 29.9211 58.5977 31.0174C58.2223 29.138 57.9922 27.1896 57.9922 25.2349C57.9922 11.3269 68.8676 0 82.3832 0C89.4074 0 95.7474 3.04473 100.204 7.96892C105.715 6.87257 110.995 4.76131 115.682 1.8732C113.871 7.73086 110.014 12.6551 104.958 15.7812C109.869 15.2299 114.628 13.8266 119 11.8719C115.682 16.8713 111.534 21.3256 106.774 24.9217Z" fill="white"/>
                    </svg>
                </div>
            </div>
            <div id="thanks">
            <div class="timer-container">
                <div class="timer-line"></div>
            </div>
                <p>At <a href="https://nanotronics.ai">Nanotronics</a>, I begin each morning entering <a href="https://nanotronics.ai/overview">Building 20</a>, where I&#8217;m greeted by a mechanical display board, reminiscent of one found in an old train station. This digital display board is populated with quotes that have been shared with the Nanotronics family since I joined the company in 2023. These quotes were selected by Paul Henrique, Security Manager for Building 20. I hope these quotes provide inspiration for you, just like they have for me&#8212;day in, day out.<br><br>&#8211; Jonathan Bobrow, UX/UI Designer</p>

                <svg id="nano_sticker" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144.35 143.28">
                  <defs>
                    <style>
                      .cls-1 {
                        fill: #ed1c24;
                      }

                      .cls-2 {
                        fill: #fff;
                      }
                    </style>
                  </defs>
                  <circle class="cls-2" cx="71.68" cy="72.28" r="63"/>
                  <path class="cls-1" d="M104.35,99.78h-16.53l-15.65-27.83-31.73,45.58V47.22h17.82l13.91,24.73,32.18-46.2v74.03ZM72.18,0C32.31,0,0,32.08,0,71.64s32.31,71.64,72.18,71.64,72.17-32.08,72.17-71.64S112.04,0,72.18,0"/>
                </svg>
            </div>
            <footer>
                Special thanks to <a href="https://jaykayess.com/Flapper/">Flapper</a> and <a href="https://jaykayess.com/">Justin Kerr Sheckler</a></footer>
            </footer>
        </div>
        <script>
            let flapDemo;
            var shareText;

            async function fetchQuotes() {
                try {
                    const response = await fetch('quotes.csv');
                    const csvText = await response.text();
                    return parseCSV(csvText);
                } catch (error) {
                    console.error('Failed to fetch quotes:', error);
                    return [];
                }
            }

            function parseCSV(csvText) {
                const rows = csvText.split('\n').slice(1); // Skip header row
                return rows
                    .map(row => {
                        // Match CSV fields, including those enclosed in double quotes
                        const columns = row.match(/(?:[^,""]+|"[^"]*")+/g);
                        if (!columns || columns.length < 3) return null; // Ensure there are at least 3 columns

                        // Remove surrounding quotes from fields and trim whitespace
                        const [date, quote, author] = columns.map(col =>
                            col.replace(/^"|"$/g, '').trim()
                        );

                        return {
                            date,
                            quote,
                            author,
                        };
                    })
                    .filter(row => 
                        row && 
                        row.quote && 
                        row.author && 
                        row.quote.length <= 100 // Filter out long quotes
                    ); // Remove empty, invalid, or overly long quotes
            }

            function formatQuoteForDisplay(quote, author, wrap, numLines) {
                const quoteText = `${quote}`;
                const buffer = new FlapBuffer(wrap, numLines);
                const words = quote.split(/\s+/);
                const authorName = `${author}`;
                const authorNameWords = authorName.split(/\s+/);

                // add quote
                words.forEach(word => buffer.pushWord(word));
                buffer.flush();

                // add author on the next line
                buffer.pushWord(`-`);
                authorNameWords.forEach(nameWord => buffer.pushWord(nameWord));
                buffer.flush();

                // console.log('Formatted buffers:', buffer.buffers);

                return buffer.buffers;
            }

            function formatQuoteForShare(quote, author) {
                combinedText = quote + ' -' + author;
                shareText = encodeURIComponent(combinedText);
            }

            function displayQuote(quotes) {
                if (quotes.length === 0) {
                    flapDemo.updateDisplay([['No quotes available.']]);
                    return;
                }

                const randomIndex = Math.floor(Math.random() * quotes.length);
                const { quote, author } = quotes[randomIndex];

                const formattedBuffers = formatQuoteForDisplay(quote, author, 22, 6); // Adjust width and line count
                flapDemo.updateDisplay(formattedBuffers);

                formatQuoteForShare(quote, author);
            }

            async function init() {
                flapDemo = new FlapDemo('input.display', '#typesomething', '#showme');
                const quotes = await fetchQuotes();
                if (quotes.length > 0) {
                    displayQuote(quotes);
                    setInterval(() => displayQuote(quotes), 30000); // Update every 30 seconds
                }
            }

            function shareQuote() {
                if(document.getElementById("twitter").style.display == "none") {
                    // bluesky quote
                    let shareURLbase = 'https://bsky.app/intent/compose?';
                    let shareURL = 'https://jbobrow.github.io/Nano-Quotes';
                    let combinedURL = shareURLbase + 'text=' + shareText + encodeURIComponent('\n\n') + shareURL;
                    window.open(combinedURL);
                }
                else {
                    let shareURLbase = 'https://x.com/intent/post?';
                    let shareURL = 'https://jbobrow.github.io/Nano-Quotes';
                    let combinedURL = shareURLbase + 'text=' + shareText + '&url=' + shareURL;
                    window.open(combinedURL);
                }
            }


            window.onkeydown = function(e) {
                if(e.keyCode==18) {
                    document.getElementById("twitter").style.display = "none";
                    document.getElementById("bluesky").style.display = "block";
                }
            }
            window.onkeyup = function(e) {
                document.getElementById("twitter").style.display = "block";
                document.getElementById("bluesky").style.display = "none";
            }

            init();
        </script>
    </body>
</html>